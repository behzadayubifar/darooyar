# دارویار API Server

This is the API server for the دارویار (Darooyar) prescription analysis application. It provides endpoints for analyzing prescription text and images.

## Getting Started

### Prerequisites

- Go 1.16 or higher
- Git
- Aval AI API Key (for AI-powered features)

### Installation

1. Clone the repository:

   ```
   git clone https://github.com/behzadayubifar/darooyar.git
   cd darooyar/server
   ```

2. Install dependencies:

   ```
   go mod download
   ```

3. Set up environment variables:

   Create a `.env` file in the server directory with the following content:

   ```
   AVALAI_API_KEY=your_avalai_api_key_here
   AVALAI_API_BASE_URL=https://api.aval.ai
   ```

   Replace `your_avalai_api_key_here` with your actual Aval AI API key.

4. Run the server:
   ```
   go run main.go
   ```

The server will start on port 8080.

## API Endpoints

### Health Check

```
GET /api/health
```

Returns the status of the API server.

### Analyze Prescription Text

```
POST /api/analyze-prescription/text
Content-Type: application/json

{
  "text": "Your prescription text here"
}
```

Returns an analysis of the prescription text.

### Analyze Prescription Image

```
POST /api/analyze-prescription/image
Content-Type: multipart/form-data

Form field: image (file)
```

Returns an analysis of the prescription image.

### AI-Powered Text Completion

```
POST /api/ai/completion
Content-Type: application/json

{
  "prompt": "Your prompt here"
}
```

Returns a completion generated by the OpenAI API.

### AI-Powered Prescription Analysis

```
POST /api/ai/analyze-prescription
Content-Type: application/json

{
  "text": "Your prescription text here"
}
```

Returns an AI-powered analysis of the prescription text using OpenAI.

## Development

### Project Structure

- `main.go`: Entry point of the application
- `handlers/`: Contains API endpoint handlers
- `models/`: Contains data models

### Adding New Features

1. Define new models in the `models/` directory
2. Create new handlers in the `handlers/` directory
3. Register new routes in `main.go`

### OpenAI Integration

The server uses the Aval AI API for AI-powered features. The integration is implemented in the `handlers/avalai.go` file. To use these features, you need to:

1. Get an API key from Aval AI
2. Set the API key in the `.env` file
3. Use the AI-powered endpoints

## License

This project is licensed under the Creative Commons Attribution-NonCommercial 4.0 International License - see the [LICENSE](../LICENSE) file for details.

This means you are free to:

- Share — copy and redistribute the material in any medium or format
- Adapt — remix, transform, and build upon the material

Under the following terms:

- Attribution — You must give appropriate credit, provide a link to the license, and indicate if changes were made.
- NonCommercial — You may not use the material for commercial purposes.
